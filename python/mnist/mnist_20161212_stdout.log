Train on 21000 samples, validate on 49000 samples
Epoch 1/100
35s - loss: 0.5671 - acc: 0.8502 - val_loss: 0.3161 - val_acc: 0.9016
Epoch 2/100
35s - loss: 0.2128 - acc: 0.9394 - val_loss: 0.3467 - val_acc: 0.8865
Epoch 3/100
36s - loss: 0.1503 - acc: 0.9563 - val_loss: 0.1994 - val_acc: 0.9394
Epoch 4/100
36s - loss: 0.1180 - acc: 0.9664 - val_loss: 0.1289 - val_acc: 0.9631
Epoch 5/100
36s - loss: 0.0962 - acc: 0.9726 - val_loss: 0.1211 - val_acc: 0.9628
Epoch 6/100
37s - loss: 0.0795 - acc: 0.9775 - val_loss: 0.1384 - val_acc: 0.9584
Epoch 7/100
35s - loss: 0.0668 - acc: 0.9813 - val_loss: 0.1006 - val_acc: 0.9689
Epoch 8/100
35s - loss: 0.0573 - acc: 0.9842 - val_loss: 0.0914 - val_acc: 0.9723
Epoch 9/100
36s - loss: 0.0498 - acc: 0.9868 - val_loss: 0.0812 - val_acc: 0.9764
Epoch 10/100
36s - loss: 0.0439 - acc: 0.9886 - val_loss: 0.0949 - val_acc: 0.9717
Epoch 11/100
36s - loss: 0.0380 - acc: 0.9906 - val_loss: 0.0853 - val_acc: 0.9741
Epoch 12/100
35s - loss: 0.0333 - acc: 0.9915 - val_loss: 0.0731 - val_acc: 0.9782
Epoch 13/100
35s - loss: 0.0297 - acc: 0.9922 - val_loss: 0.0720 - val_acc: 0.9784
Epoch 14/100
36s - loss: 0.0263 - acc: 0.9934 - val_loss: 0.0725 - val_acc: 0.9785
Epoch 15/100
36s - loss: 0.0241 - acc: 0.9942 - val_loss: 0.1107 - val_acc: 0.9651
Epoch 16/100
35s - loss: 0.0201 - acc: 0.9957 - val_loss: 0.0681 - val_acc: 0.9798
Epoch 17/100
35s - loss: 0.0186 - acc: 0.9963 - val_loss: 0.0728 - val_acc: 0.9782
Epoch 18/100
35s - loss: 0.0169 - acc: 0.9967 - val_loss: 0.0685 - val_acc: 0.9796
Epoch 19/100
36s - loss: 0.0145 - acc: 0.9975 - val_loss: 0.0690 - val_acc: 0.9801
Epoch 20/100
35s - loss: 0.0134 - acc: 0.9970 - val_loss: 0.0722 - val_acc: 0.9793
Epoch 21/100
36s - loss: 0.0116 - acc: 0.9982 - val_loss: 0.0696 - val_acc: 0.9807
Epoch 22/100
36s - loss: 0.0102 - acc: 0.9985 - val_loss: 0.0674 - val_acc: 0.9813
Epoch 23/100
36s - loss: 0.0090 - acc: 0.9988 - val_loss: 0.0732 - val_acc: 0.9795
Epoch 24/100
36s - loss: 0.0081 - acc: 0.9990 - val_loss: 0.0687 - val_acc: 0.9808
Epoch 25/100
36s - loss: 0.0075 - acc: 0.9991 - val_loss: 0.0694 - val_acc: 0.9808
Epoch 26/100
36s - loss: 0.0064 - acc: 0.9994 - val_loss: 0.0707 - val_acc: 0.9812
Epoch 27/100
36s - loss: 0.0057 - acc: 0.9995 - val_loss: 0.0689 - val_acc: 0.9815
Epoch 28/100
35s - loss: 0.0048 - acc: 0.9997 - val_loss: 0.0732 - val_acc: 0.9811
Epoch 29/100
35s - loss: 0.0046 - acc: 0.9996 - val_loss: 0.0726 - val_acc: 0.9810
Epoch 30/100
35s - loss: 0.0041 - acc: 0.9996 - val_loss: 0.0753 - val_acc: 0.9807
Epoch 31/100
35s - loss: 0.0035 - acc: 0.9998 - val_loss: 0.0725 - val_acc: 0.9815
Epoch 32/100
36s - loss: 0.0032 - acc: 0.9997 - val_loss: 0.0759 - val_acc: 0.9811
Epoch 33/100
35s - loss: 0.0027 - acc: 0.9999 - val_loss: 0.0759 - val_acc: 0.9813
Epoch 34/100
35s - loss: 0.0024 - acc: 0.9999 - val_loss: 0.0764 - val_acc: 0.9809
Epoch 35/100
35s - loss: 0.0023 - acc: 0.9998 - val_loss: 0.0753 - val_acc: 0.9819
Epoch 36/100
36s - loss: 0.0019 - acc: 0.9998 - val_loss: 0.0760 - val_acc: 0.9816
Epoch 37/100
36s - loss: 0.0018 - acc: 0.9999 - val_loss: 0.0797 - val_acc: 0.9813
Epoch 38/100
36s - loss: 0.0015 - acc: 0.9999 - val_loss: 0.0762 - val_acc: 0.9820
Epoch 39/100
36s - loss: 0.0013 - acc: 1.0000 - val_loss: 0.0789 - val_acc: 0.9818
Epoch 40/100
35s - loss: 0.0013 - acc: 1.0000 - val_loss: 0.0783 - val_acc: 0.9820
Epoch 41/100
36s - loss: 0.0011 - acc: 1.0000 - val_loss: 0.0798 - val_acc: 0.9818
Epoch 42/100
35s - loss: 9.6236e-04 - acc: 1.0000 - val_loss: 0.0826 - val_acc: 0.9816
Epoch 43/100
36s - loss: 8.3592e-04 - acc: 1.0000 - val_loss: 0.0811 - val_acc: 0.9822
Epoch 44/100
36s - loss: 7.7709e-04 - acc: 1.0000 - val_loss: 0.0822 - val_acc: 0.9821
Epoch 45/100
36s - loss: 6.7884e-04 - acc: 1.0000 - val_loss: 0.0836 - val_acc: 0.9817
Epoch 46/100
36s - loss: 6.7061e-04 - acc: 1.0000 - val_loss: 0.0863 - val_acc: 0.9813
Epoch 47/100
35s - loss: 5.6568e-04 - acc: 1.0000 - val_loss: 0.0855 - val_acc: 0.9819
Epoch 48/100
35s - loss: 4.6410e-04 - acc: 1.0000 - val_loss: 0.0853 - val_acc: 0.9818
Epoch 49/100
35s - loss: 4.7560e-04 - acc: 1.0000 - val_loss: 0.0865 - val_acc: 0.9822
Epoch 50/100
36s - loss: 3.9829e-04 - acc: 1.0000 - val_loss: 0.0869 - val_acc: 0.9817
Epoch 51/100
35s - loss: 3.8017e-04 - acc: 1.0000 - val_loss: 0.0893 - val_acc: 0.9819
Epoch 52/100
36s - loss: 3.2896e-04 - acc: 1.0000 - val_loss: 0.0876 - val_acc: 0.9820
Epoch 53/100
35s - loss: 2.9678e-04 - acc: 1.0000 - val_loss: 0.0896 - val_acc: 0.9818
Epoch 54/100
35s - loss: 2.7422e-04 - acc: 1.0000 - val_loss: 0.0901 - val_acc: 0.9822
Epoch 55/100
36s - loss: 2.7436e-04 - acc: 1.0000 - val_loss: 0.0978 - val_acc: 0.9794
Epoch 56/100
35s - loss: 3.3969e-04 - acc: 0.9999 - val_loss: 0.0926 - val_acc: 0.9818
Epoch 57/100
35s - loss: 2.1790e-04 - acc: 1.0000 - val_loss: 0.0920 - val_acc: 0.9820
Epoch 58/100
36s - loss: 2.0811e-04 - acc: 1.0000 - val_loss: 0.0929 - val_acc: 0.9822
Epoch 59/100
36s - loss: 1.8339e-04 - acc: 1.0000 - val_loss: 0.0936 - val_acc: 0.9816
Epoch 60/100
35s - loss: 1.7828e-04 - acc: 1.0000 - val_loss: 0.0941 - val_acc: 0.9822
Epoch 61/100
35s - loss: 1.5950e-04 - acc: 1.0000 - val_loss: 0.0945 - val_acc: 0.9822
Epoch 62/100
36s - loss: 1.5299e-04 - acc: 1.0000 - val_loss: 0.0954 - val_acc: 0.9820
Epoch 63/100
35s - loss: 1.3921e-04 - acc: 1.0000 - val_loss: 0.0982 - val_acc: 0.9811
Epoch 64/100
36s - loss: 1.3338e-04 - acc: 1.0000 - val_loss: 0.0960 - val_acc: 0.9821
Epoch 65/100
36s - loss: 1.2351e-04 - acc: 1.0000 - val_loss: 0.0963 - val_acc: 0.9821
Epoch 66/100
35s - loss: 1.1775e-04 - acc: 1.0000 - val_loss: 0.0975 - val_acc: 0.9820
Epoch 67/100
36s - loss: 1.0901e-04 - acc: 1.0000 - val_loss: 0.0973 - val_acc: 0.9821
Epoch 68/100
35s - loss: 1.0441e-04 - acc: 1.0000 - val_loss: 0.0978 - val_acc: 0.9821
Epoch 69/100
35s - loss: 9.6566e-05 - acc: 1.0000 - val_loss: 0.1034 - val_acc: 0.9810
Epoch 70/100
36s - loss: 9.5998e-05 - acc: 1.0000 - val_loss: 0.0996 - val_acc: 0.9820
Epoch 71/100
36s - loss: 8.7040e-05 - acc: 1.0000 - val_loss: 0.1001 - val_acc: 0.9818
Epoch 72/100
35s - loss: 8.6110e-05 - acc: 1.0000 - val_loss: 0.1006 - val_acc: 0.9821
Epoch 73/100
35s - loss: 8.2147e-05 - acc: 1.0000 - val_loss: 0.1005 - val_acc: 0.9819
Epoch 74/100
36s - loss: 7.9094e-05 - acc: 1.0000 - val_loss: 0.1013 - val_acc: 0.9819
Epoch 75/100
35s - loss: 7.4057e-05 - acc: 1.0000 - val_loss: 0.1008 - val_acc: 0.9821
Epoch 76/100
35s - loss: 7.2816e-05 - acc: 1.0000 - val_loss: 0.1011 - val_acc: 0.9821
Epoch 77/100
36s - loss: 6.8469e-05 - acc: 1.0000 - val_loss: 0.1022 - val_acc: 0.9821
Epoch 78/100
36s - loss: 6.5569e-05 - acc: 1.0000 - val_loss: 0.1021 - val_acc: 0.9819
Epoch 79/100
36s - loss: 6.4281e-05 - acc: 1.0000 - val_loss: 0.1023 - val_acc: 0.9821
Epoch 80/100
36s - loss: 6.0575e-05 - acc: 1.0000 - val_loss: 0.1034 - val_acc: 0.9819
Epoch 81/100
36s - loss: 5.8756e-05 - acc: 1.0000 - val_loss: 0.1030 - val_acc: 0.9821
Epoch 82/100
36s - loss: 5.6881e-05 - acc: 1.0000 - val_loss: 0.1032 - val_acc: 0.9821
Epoch 83/100
35s - loss: 5.4829e-05 - acc: 1.0000 - val_loss: 0.1040 - val_acc: 0.9819
Epoch 84/100
35s - loss: 5.2570e-05 - acc: 1.0000 - val_loss: 0.1041 - val_acc: 0.9821
Epoch 85/100
36s - loss: 5.1695e-05 - acc: 1.0000 - val_loss: 0.1045 - val_acc: 0.9820
Epoch 86/100
35s - loss: 5.0292e-05 - acc: 1.0000 - val_loss: 0.1047 - val_acc: 0.9819
Epoch 87/100
36s - loss: 4.8918e-05 - acc: 1.0000 - val_loss: 0.1050 - val_acc: 0.9820
Epoch 88/100
35s - loss: 4.6804e-05 - acc: 1.0000 - val_loss: 0.1048 - val_acc: 0.9820
Epoch 89/100
35s - loss: 4.5601e-05 - acc: 1.0000 - val_loss: 0.1058 - val_acc: 0.9821
Epoch 90/100
36s - loss: 4.4023e-05 - acc: 1.0000 - val_loss: 0.1061 - val_acc: 0.9818
Epoch 91/100
36s - loss: 4.3209e-05 - acc: 1.0000 - val_loss: 0.1059 - val_acc: 0.9821
Epoch 92/100
35s - loss: 4.1807e-05 - acc: 1.0000 - val_loss: 0.1064 - val_acc: 0.9820
Epoch 93/100
35s - loss: 4.0915e-05 - acc: 1.0000 - val_loss: 0.1061 - val_acc: 0.9820
Epoch 94/100
36s - loss: 3.9727e-05 - acc: 1.0000 - val_loss: 0.1064 - val_acc: 0.9820
Epoch 95/100
35s - loss: 3.8446e-05 - acc: 1.0000 - val_loss: 0.1065 - val_acc: 0.9820
Epoch 96/100
35s - loss: 3.7509e-05 - acc: 1.0000 - val_loss: 0.1070 - val_acc: 0.9819
Epoch 97/100
35s - loss: 3.7238e-05 - acc: 1.0000 - val_loss: 0.1073 - val_acc: 0.9820
Epoch 98/100
36s - loss: 3.5656e-05 - acc: 1.0000 - val_loss: 0.1068 - val_acc: 0.9820
Epoch 99/100
38s - loss: 3.5512e-05 - acc: 1.0000 - val_loss: 0.1074 - val_acc: 0.9821
Epoch 100/100
37s - loss: 3.4307e-05 - acc: 1.0000 - val_loss: 0.1074 - val_acc: 0.9820
Test score: 0.107365115248
Test accuracy: 0.981979591837
0.9818979591836735
[[4784    1    8    0    3    5   19    2    8    6]
 [   4 5476   12    2    5    1    8   12    3    0]
 [   7   16 4726   18   17    0   11   40   16    4]
 [  10    4   16 4887    0   25    1   17   21   17]
 [   3   11    4    0 4704    0    7   11    3   26]
 [  13    6    2   22    3 4360   23    0   14    5]
 [  16    5    1    0   15   10 4786    0   13    0]
 [   6    9   24    3   10    3    0 5010    2   20]
 [  14   14   14   19   17   18    7    4 4668   11]
 [  13   11    1   28   27    9    2   26   23 4712]]
